# 数据库  
  
**1. 数据库索引是干什么的？有什么优点？**  
* 大大加快了数据的检索速度；  
* 可以显著减少查询中分组和排序的时间；  
* 通过创建唯一性索引，可以保证数据库表中每一行数据的唯一性；  
* 将随机 I/O 变为顺序 I/O。   
  
**2. 什么是乐观锁和悲观锁？**  
* 乐观锁：操作数据时不会上锁，但是更新时会判断在此期间有没有别的事务更新这个数据，若被更新过，则失败重试；适用于读多写少的场景；  
* 悲观锁：认为数据随时会被修改，因此每次读取数据之前都会上锁，防止其它事务读取或修改数据；应用于数据更新比较频繁的场景。  
  
**3. 哪些情况下索引会失效？**  
* 以“%(表示任意0个或多个字符)”开头的LIKE语句；  
* OR语句前后没有同时使用索引；  
* 数据类型出现隐式转化（如varchar不加单引号的话可能会自动转换为int型）；  
* 对于多列索引，必须满足 最左匹配原则/最左前缀原则 (最左优先，eg：多列索引col1、col2和col3，则 索引生效的情形包括 col1或col1，col2或col1，col2，col3)；  
* 如果MySQL估计全表扫描比索引快，则不使用索引（比如非常小的表）  
  
**4. 在哪些地方适合创建索引？**  
* 某列经常作为最大最小值；  
* 经常被查询的字段；  
* 经常用作表连接的字段；  
* 经常出现在ORDER BY/GROUP BY/DISDINCT后面的字段  
  
**5. 索引的分类？**  
* 普通索引
* 唯一索引
* 主键索引
* 单列索引和多列索引
* 覆盖索引
* 聚集索引
* 分区索引
* 虚拟索引
  
**6. MySQL的两种存储引擎 InnoDB 和 MyISAM 的区别？**  
* InnoDB不支持全文搜索，MyISAM支持全文搜索；
* InnoDB支持事务，可以进行Commit和Rollback，MyISAM不支持事物；  
* MyISAM 只支持表级锁，而 InnoDB 还支持行级锁，提高了并发操作的性能；  
* InnoDB 支持外键；  
* MyISAM 崩溃后发生损坏的概率比 InnoDB 高很多，而且恢复的速度也更慢；  
* MyISAM 支持压缩表和空间数据索引，InnoDB需要更多的内存和存储；  
* InnoDB 支持在线热备份  
  
**7. 如何优化数据库？**  
* SQL 语句的优化  
* 索引的优化  
* 数据库表结构的优化  
* 系统配置的优化  
* 硬件的优化  
  
**8. 什么是主从复制？实现原理是什么？**  
主从复制（Replication）是指数据可以从一个MySQL数据库主服务器复制到一个或多个从服务器，从服务器可以复制主服务器中的所有数据库或者特定的数据库，或者特定的表。默认采用异步模式。  
实现原理：  
  
* 主服务器 binary log dump 线程：将主服务器中的数据更改（增删改）日志写入 Binary log 中；  
* 从服务器 I/O 线程：负责从主服务器读取binary log，并写入本地的 Relay log；  
* 从服务器 SQL 线程：负责读取 Relay log，解析出主服务器已经执行的数据更改，并在从服务器中重新执行（Replay），保证主从数据的一致性  
  
**9. 事务的概念和特性？**  
概念：事务（Transaction）是一个操作序列，不可分割的工作单位，以BEGIN TRANSACTION开始，以ROLLBACK/COMMIT结束  
  
特性（ACID）：  
  
* 原子性（Atomicity）：逻辑上是不可分割的操作单元，事务的所有操作要么全部提交成功，要么全部失败回滚（用回滚日志实现，反向执行日志中的操作）；  
* 一致性（Consistency）：事务的执行必须使数据库保持一致性状态。在一致性状态下，所有事务对一个数据的读取结果都是相同的；  
* 隔离性（Isolation）：一个事务所做的修改在最终提交以前，对其它事务是不可见的（并发执行的事务之间不能相互影响）；  
* 持久性（Durability）：一旦事务提交成功，对数据的修改是永久性的。  
  
**10. 数据库的范式？**  
* 第一范式（1NF，Normal Form）：属性不应该是可分的。  
* 第二范式 2NF：每个非主属性完全依赖于主属性集（候选键集）；  
* 第三范式 3NF：在 2NF 的基础上，非主属性不传递依赖于主属性。  
  
**11. DELETE/TRUNCATE/DROP的区别？**  
  
DELETE|TRUNCATE|DROP  
-----|-----|-----  
DELETE用来删除表的全部或部分数据|TRUNCATE删除表中的所有数据|DROP从数据库中删除表  
  
*MySQL没有撤销（undo）按钮，应该非常小心地使用UPDATE和DELETE，否则你会发现自己更新或删除了错误的数据。*
  
**12. WHERE/HAVING的区别？**  
  
WHERE|HAVING  
-----|-----  
WHERE在数据分组前进行过滤|HAVING在数据分组后进行过滤  
  
**13. ORDER BY/GROUP BY的区别？**  
  
ORDER BY|GROUP BY  
-----|-----  
排序产生的输出|分组行。但输出可能不是分组的顺序  
任意列都可以使用|只可能使用选择列或表达式列，而且必须使用每个选择列表达式  
不一定需要|如果与聚集函数一起使用列（或表达式），则必须使用  
   
**14. SELECT子句顺序？**  
  
子句|说明|是否必须使用  
-----|-----|-----  
SELECT|要返回的列或表达式|是  
FROM|从中检索数据的表|仅在从表选择数据时使用  
WHERE|行级过滤|否  
GROUP BY|分组说明|仅在按组计算聚集时使用  
HAVING|组级过滤|否  
ORDER BY|输出排序顺序|否  
LIMIT|要检索的行数|否  
  
**15. 内连接/左连接/右连接的区别？**  
  
内连接|左连接|右连接  
-----|-----|-----  
返回两个表相同的部分|返回左边表中的所有行+右边行里与左边行相同的部分|返回右边表中的所有行+左边行里与右边行相同的部分  
  
**16. UNION/UNION ALL的区别？**  
  
UNION|UNION ALL  
-----|-----  
把输出组合成单个结果集，去除重复的行|把输出组合成单个结果集，不去除重复的行  
  
**17. 视图的作用？**  
  
视图主要用于检索，而不用于更新。视图极大地简化了复杂SQL语句的使用，利用视图，可一次性编写基础的SQL，然后根据需要多次使用。  
  
**18. MySQL的两种注释方法：--  和 /*  
  
**19. MySQL游标的作用：在检索出来的行中前进或后退一行或多行。  
  
**20. E-R关系图(实体-联系图(Entity Relationship Diagram)):   
  
实体:方框  
属性:椭圆  
关系:菱形

**21. 














